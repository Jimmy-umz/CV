<!--員工  客戶管理頁面-->

<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>客戶管理 - Smile & Sunshine Toys</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    />
    <link rel="stylesheet" href="CSS/customer-management.css" />
  </head>
  <body class="staff-mode">
    <!-- 頁頭 -->
    <header class="theme-header">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-smile"></i>
          <h1>Smile & Sunshine 員工系統</h1>
        </div>
        <div class="nav-links" id="nav-links">
          <!-- 導航鏈接會通過 JS 動態生成 -->
        </div>
      </div>
    </header>

    <!-- 主內容區 -->
    <div class="dashboard-container">
      <!-- 側邊欄 -->
      <div class="sidebar">
        <div class="staff-info">
          <div class="staff-avatar">
            <i class="fas fa-user-tie"></i>
          </div>
          <div class="staff-details">
            <h3 id="staff-name">員工名稱</h3>
            <p>銷售經理</p>
            <div class="staff-status">
              <i class="fas fa-circle"></i>
              <span>在線</span>
            </div>
          </div>
        </div>

        <nav class="sidebar-nav">
          <a href="sales-dashboard.html" class="nav-item">
            <i class="fas fa-tachometer-alt"></i>
            <span>儀表板</span>
          </a>
          <a href="product-management.html" class="nav-item">
            <i class="fas fa-boxes"></i>
            <span>商品管理</span>
          </a>
          <a href="order-management.html" class="nav-item">
            <i class="fas fa-clipboard-list"></i>
            <span>訂單管理</span>
          </a>
          <a href="customer-management.html" class="nav-item active">
            <i class="fas fa-users"></i>
            <span>客戶管理</span>
          </a>
          <a href="quotation-management.html" class="nav-item">
            <i class="fas fa-file-invoice-dollar"></i>
            <span>報價管理</span>
          </a>
          <a href="staff-profile.html" class="nav-item">
            <i class="fas fa-user-cog"></i>
            <span>員工中心</span>
          </a>
        </nav>

        <div class="sidebar-footer">
          <div class="quick-stats">
            <div class="quick-stat">
              <i class="fas fa-users"></i>
              <div>
                <span class="stat-number" id="total-customers">0</span>
                <span class="stat-label">總客戶數</span>
              </div>
            </div>
            <div class="quick-stat">
              <i class="fas fa-crown"></i>
              <div>
                <span class="stat-number" id="vip-customers">0</span>
                <span class="stat-label">VIP客戶</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 主內容 -->
      <div class="main-content">
        <!-- 頁面標題和快速操作 -->
        <div class="page-header">
          <div class="header-title">
            <h1><i class="fas fa-users"></i> 客戶管理</h1>
            <p>檢視客戶資料、消費紀錄與服務管理</p>
          </div>
          <div class="header-actions">
            <button class="btn-primary" onclick="exportCustomerReport()">
              <i class="fas fa-download"></i> 匯出報表
            </button>
            <button class="btn-secondary" onclick="refreshData()">
              <i class="fas fa-sync-alt"></i> 重新整理
            </button>
          </div>
        </div>

        <!-- KPI 指標卡片 -->
        <div class="kpi-cards">
          <div class="kpi-card revenue">
            <div class="kpi-icon">
              <i class="fas fa-users"></i>
            </div>
            <div class="kpi-content">
              <div class="kpi-value" id="total-customers-kpi">0</div>
              <div class="kpi-label">總客戶數</div>
              <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                <span>8.5% 較上期</span>
              </div>
            </div>
          </div>

          <div class="kpi-card orders">
            <div class="kpi-icon">
              <i class="fas fa-user-plus"></i>
            </div>
            <div class="kpi-content">
              <div class="kpi-value" id="new-customers">0</div>
              <div class="kpi-label">本月新增</div>
              <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                <span>12.3% 較上月</span>
              </div>
            </div>
          </div>

          <div class="kpi-card customers">
            <div class="kpi-icon">
              <i class="fas fa-crown"></i>
            </div>
            <div class="kpi-content">
              <div class="kpi-value" id="vip-count">0</div>
              <div class="kpi-label">VIP客戶</div>
              <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                <span>5.7% 較上期</span>
              </div>
            </div>
          </div>

          <div class="kpi-card conversion">
            <div class="kpi-icon">
              <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="kpi-content">
              <div class="kpi-value" id="avg-order-value">$0</div>
              <div class="kpi-label">平均客單價</div>
              <div class="kpi-trend positive">
                <i class="fas fa-arrow-up"></i>
                <span>3.2% 較上期</span>
              </div>
            </div>
          </div>
        </div>

        <!-- 搜索和篩選 -->
        <div class="search-filter-bar">
          <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input
              type="text"
              id="customer-search"
              class="search-input"
              placeholder="搜尋客戶姓名、電話或電子郵件..."
            />
          </div>
          <select id="tier-filter" class="filter-select">
            <option value="">所有等級</option>
            <option value="vip">VIP客戶</option>
            <option value="regular">一般客戶</option>
            <option value="new">新客戶</option>
          </select>
          <select id="status-filter" class="filter-select">
            <option value="">所有狀態</option>
            <option value="active">活躍客戶</option>
            <option value="inactive">非活躍客戶</option>
          </select>
          <select id="region-filter" class="filter-select">
            <option value="">所有地區</option>
            <option value="north">北部</option>
            <option value="central">中部</option>
            <option value="south">南部</option>
            <option value="east">東部</option>
          </select>
        </div>

        <!-- 客戶列表 -->
        <div class="table-card">
          <div class="table-header">
            <h3>客戶列表</h3>
            <div class="table-actions">
              <span id="customer-count">共 0 位客戶</span>
              <button class="btn-secondary" onclick="sendBulkMessage()">
                <i class="fas fa-envelope"></i> 群發訊息
              </button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>客戶編號</th>
                  <th>客戶資訊</th>
                  <th>聯絡方式</th>
                  <th>地區</th>
                  <th>消費統計</th>
                  <th>客戶等級</th>
                  <th>狀態</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody id="customers-table">
                <!-- 客戶數據會通過 JS 動態生成 -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- 客戶分佈圖表 -->
        <div class="charts-grid">
          <!-- 客戶地區分佈 -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>客戶地區分佈</h3>
            </div>
            <div class="chart-container">
              <canvas id="region-chart"></canvas>
            </div>
          </div>

          <!-- 客戶等級分佈 -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>客戶等級分佈</h3>
            </div>
            <div class="chart-container">
              <canvas id="tier-chart"></canvas>
            </div>
          </div>

          <!-- 消費金額分佈 -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>消費金額分佈</h3>
            </div>
            <div class="chart-container">
              <canvas id="spending-chart"></canvas>
            </div>
          </div>

          <!-- 客戶增長趨勢 -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>客戶增長趨勢</h3>
            </div>
            <div class="chart-container">
              <canvas id="growth-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 客戶詳情模態框 -->
    <div class="modal" id="customer-detail-modal">
      <div class="modal-content large">
        <div class="modal-header">
          <h3 id="customer-detail-title">客戶詳情</h3>
          <button class="close-modal" onclick="closeCustomerModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="customer-detail-tabs">
            <div class="tab-headers">
              <button class="tab-header active" data-tab="profile">
                基本資料
              </button>
              <button class="tab-header" data-tab="orders">消費紀錄</button>
              <button class="tab-header" data-tab="service">服務紀錄</button>
              <button class="tab-header" data-tab="notes">備註</button>
            </div>

            <div class="tab-content">
              <!-- 基本資料標籤頁 -->
              <div class="tab-pane active" id="profile-tab">
                <div id="customer-profile-content">
                  <!-- 客戶基本資料內容會通過 JS 動態生成 -->
                </div>
              </div>

              <!-- 消費紀錄標籤頁 -->
              <div class="tab-pane" id="orders-tab">
                <div id="customer-orders-content">
                  <!-- 客戶消費紀錄內容會通過 JS 動態生成 -->
                </div>
              </div>

              <!-- 服務紀錄標籤頁 -->
              <div class="tab-pane" id="service-tab">
                <div id="customer-service-content">
                  <!-- 客戶服務紀錄內容會通過 JS 動態生成 -->
                </div>
              </div>

              <!-- 備註標籤頁 -->
              <div class="tab-pane" id="notes-tab">
                <div class="notes-section">
                  <h4><i class="fas fa-sticky-note"></i> 客戶備註</h4>
                  <div id="customer-notes-list">
                    <!-- 備註列表會通過 JS 動態生成 -->
                  </div>
                  <div class="add-note-section">
                    <h5>新增備註</h5>
                    <textarea
                      id="new-customer-note"
                      class="form-textarea"
                      rows="4"
                      placeholder="輸入客戶備註..."
                    ></textarea>
                    <button class="btn-primary" onclick="addCustomerNote()">
                      <i class="fas fa-plus"></i> 新增備註
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeCustomerModal()">
            關閉
          </button>
          <button class="btn-primary" onclick="editCustomer()">
            <i class="fas fa-edit"></i> 編輯資料
          </button>
        </div>
      </div>
    </div>

    <!-- 編輯客戶模態框 -->
    <div class="modal" id="edit-customer-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="edit-customer-title">編輯客戶資料</h3>
          <button class="close-modal" onclick="closeEditCustomerModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="edit-customer-form" class="form-grid">
            <div class="form-group">
              <label class="form-label">客戶姓名</label>
              <input
                type="text"
                id="edit-customer-name"
                class="form-input"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">電話號碼</label>
              <input
                type="tel"
                id="edit-customer-phone"
                class="form-input"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">電子郵件</label>
              <input
                type="email"
                id="edit-customer-email"
                class="form-input"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">客戶等級</label>
              <select id="edit-customer-tier" class="form-select" required>
                <option value="regular">一般客戶</option>
                <option value="vip">VIP客戶</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">地區</label>
              <select id="edit-customer-region" class="form-select" required>
                <option value="north">北部</option>
                <option value="central">中部</option>
                <option value="south">南部</option>
                <option value="east">東部</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">地址</label>
              <input
                type="text"
                id="edit-customer-address"
                class="form-input"
              />
            </div>
            <div class="form-group full-width">
              <label class="form-label">備註</label>
              <textarea
                id="edit-customer-notes"
                class="form-textarea"
                rows="3"
              ></textarea>
            </div>
          </form>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeEditCustomerModal()">
            取消
          </button>
          <button class="btn-primary" onclick="saveCustomer()">
            <i class="fas fa-save"></i> 儲存變更
          </button>
        </div>
      </div>
    </div>

    <!-- 群發訊息模態框 -->
    <div class="modal" id="bulk-message-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>群發客戶訊息</h3>
          <button class="close-modal" onclick="closeBulkMessageModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="bulk-message-form">
            <div class="form-group">
              <label class="form-label">發送對象</label>
              <select id="message-target" class="form-select" required>
                <option value="all">所有客戶</option>
                <option value="vip">VIP客戶</option>
                <option value="regular">一般客戶</option>
                <option value="inactive">非活躍客戶</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">訊息標題</label>
              <input
                type="text"
                id="message-title"
                class="form-input"
                required
                placeholder="輸入訊息標題..."
              />
            </div>
            <div class="form-group">
              <label class="form-label">訊息內容</label>
              <textarea
                id="message-content"
                class="form-textarea"
                rows="6"
                required
                placeholder="輸入訊息內容..."
              ></textarea>
            </div>
            <div class="recipient-count">
              <i class="fas fa-info-circle"></i>
              預計發送給 <span id="recipient-count">0</span> 位客戶
            </div>
          </form>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeBulkMessageModal()">
            取消
          </button>
          <button class="btn-primary" onclick="sendBulkMessageConfirm()">
            <i class="fas fa-paper-plane"></i> 發送訊息
          </button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="JS/customer-management.js"></script>
  </body>
</html>
